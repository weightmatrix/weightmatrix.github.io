<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>李知本时间管理 Pro - 技术支持与使用手册</title>
    <style>
        :root {
            --bg-color: #0d0d0d;
            --sidebar-bg: #161618;
            --text-primary: #f5f5f7;
            --text-secondary: #86868b;
            --accent-blue: #2997ff;
            --accent-purple: #bf5af2;
            --accent-orange: #ff9500;
            --accent-green: #30d158;
            --accent-red: #ff453a;
            --border-color: #38383a;
            --code-bg: #2c2c2e;
            --card-bg: #1c1c1e;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
            line-height: 1.6;
        }

        /* --- 侧边栏 --- */
        aside {
            width: 280px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 100;
        }

        .sidebar-header {
            padding: 30px 20px 10px 20px;
        }

        .app-title {
            font-size: 1.1rem;
            font-weight: 800;
            background: linear-gradient(135deg, #fff 0%, #a1a1a6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* 侧边栏 - 联系区域 */
        .contact-box {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background-color: rgba(41, 151, 255, 0.05);
        }

        .contact-label {
            font-size: 0.75rem;
            color: var(--accent-blue);
            font-weight: bold;
            margin-bottom: 8px;
            display: block;
        }

        .email-link {
            color: var(--text-primary);
            text-decoration: none;
            font-family: monospace;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            transition: opacity 0.2s;
        }
        
        .email-link:hover { opacity: 0.8; }
        .email-icon { margin-right: 8px; }

        /* 侧边栏 - 导航 */
        nav {
            overflow-y: auto;
            flex: 1;
            padding: 20px;
        }

        nav ul { list-style: none; padding: 0; margin: 0; }
        nav li { margin-bottom: 4px; }

        nav a {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-radius: 8px;
            transition: all 0.2s;
        }

        nav a:hover {
            background-color: rgba(255,255,255,0.05);
            color: var(--text-primary);
        }

        nav a.active {
            background-color: rgba(41, 151, 255, 0.15);
            color: var(--accent-blue);
            font-weight: 600;
        }

        nav .icon { margin-right: 10px; width: 20px; text-align: center; }

        /* --- 主内容区 --- */
        main {
            flex: 1;
            overflow-y: auto;
            padding: 40px 60px;
            scroll-behavior: smooth;
        }

        /* 支持区域 Hero */
        .support-hero {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        h1 { font-size: 2.5rem; margin-bottom: 15px; letter-spacing: -0.5px; }
        
        .intro-text {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin-bottom: 30px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            text-decoration: none;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.98); }

        .btn-primary {
            background-color: var(--accent-blue);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--code-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        /* 手册排版 */
        h2 { 
            font-size: 1.8rem; 
            margin-top: 60px; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--accent-blue);
        }
        h3 { 
            font-size: 1.3rem; 
            margin-top: 40px; 
            margin-bottom: 15px; 
            color: var(--text-primary);
            display: flex;
            align-items: center;
        }
        h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 1.2em;
            background-color: var(--accent-purple);
            margin-right: 10px;
            border-radius: 2px;
        }

        p { margin-bottom: 15px; color: #d1d1d6; }

        /* 功能卡片样式 */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s, border-color 0.2s;
        }

        .card:hover { transform: translateY(-2px); border-color: var(--accent-blue); }
        .card h4 { margin: 0 0 10px 0; color: var(--accent-orange); font-size: 1.1rem; }
        
        /* 操作标签 */
        .gesture {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            margin-right: 6px;
            vertical-align: middle;
        }
        .g-tap { background: rgba(48, 209, 88, 0.2); color: var(--accent-green); border: 1px solid rgba(48, 209, 88, 0.3); }
        .g-long { background: rgba(255, 149, 0, 0.2); color: var(--accent-orange); border: 1px solid rgba(255, 149, 0, 0.3); }
        .g-drag { background: rgba(10, 132, 255, 0.2); color: var(--accent-blue); border: 1px solid rgba(10, 132, 255, 0.3); }
        .g-swipe { background: rgba(255, 69, 58, 0.2); color: var(--accent-red); border: 1px solid rgba(255, 69, 58, 0.3); }

        /* 细节列表 */
        ul.detail-list { padding-left: 20px; }
        ul.detail-list li { margin-bottom: 8px; color: #aeaeb2; }
        strong { color: var(--text-primary); }

        /* 提示框 */
        .tip-box {
            background: rgba(191, 90, 242, 0.1);
            border-left: 4px solid var(--accent-purple);
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        /* 快捷键 */
        kbd {
            background-color: var(--code-bg);
            border-radius: 4px;
            border: 1px solid #48484a;
            box-shadow: 0 2px 0 #000;
            color: #fff;
            display: inline-block;
            font-family: monospace;
            font-size: 0.85em;
            padding: 2px 6px;
            margin: 0 2px;
        }

        /* 复制成功提示 */
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        #toast.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @-webkit-keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @-webkit-keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        /* 移动端适配 */
        @media (max-width: 900px) {
            body { flex-direction: column; height: auto; overflow: auto; }
            aside { width: 100%; height: auto; border-right: none; border-bottom: 1px solid var(--border-color); }
            nav { display: none; } /* 移动端隐藏侧边栏导航，只留头部联系方式 */
            .contact-box { background-color: var(--sidebar-bg); }
            main { padding: 30px 20px; }
            .feature-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<!-- 侧边栏 -->
<aside>
    <div class="sidebar-header">
        <div class="app-title">李知本时间管理 Pro</div>
        <div class="subtitle">Technical Support</div>
    </div>
    
    <div class="contact-box">
        <span class="contact-label">开发者邮箱 / Developer Email</span>
        <a href="mailto:weightmatrix09@163.com" class="email-link" onclick="copyEmail(event)">
            <span class="email-icon">✉️</span> weightmatrix09@163.com
        </a>
    </div>

    <nav>
        <ul>
            <li><a href="#intro" class="active"><span class="icon">👋</span> 开始</a></li>
            <li><a href="#home"><span class="icon">🏠</span> 1. 首页 (Home)</a></li>
            <li><a href="#tasks"><span class="icon">✅</span> 2. 任务清单 (Tasks)</a></li>
            <li><a href="#calendar"><span class="icon">📅</span> 3. 日程日历 (Calendar)</a></li>
            <li><a href="#archives"><span class="icon">🗂</span> 4. 档案库 (Archives)</a></li>
            <li><a href="#goals"><span class="icon">🎯</span> 5. 目标管理 (Goals)</a></li>
            <li><a href="#records"><span class="icon">📊</span> 6. 历史记录 (Records)</a></li>
            <li><a href="#pomodoro"><span class="icon">🍅</span> 7. 番茄专注 (Pomodoro)</a></li>
            <li><a href="#settings"><span class="icon">⚙️</span> 8. 设置 (Settings)</a></li>
        </ul>
    </nav>
</aside>

<!-- 主内容 -->
<main>
    <!-- 顶部支持 Hero 区域 -->
    <section id="intro" class="support-hero">
        <h1>技术支持与用户手册</h1>
        <p class="intro-text">
            感谢使用李知本时间管理 Pro。如果您在使用过程中遇到问题、发现 Bug 或有功能建议，请通过邮件联系我。作为独立开发者，我会尽力回复每一封邮件并持续改进 App。
        </p>
        <div class="action-buttons">
            <a href="mailto:weightmatrix09@163.com" class="btn btn-primary">发送邮件反馈</a>
            <button class="btn btn-secondary" onclick="copyEmail()">复制邮箱地址</button>
        </div>
    </section>

    <!-- 下方嵌入详细手册内容 -->
    
    <!-- 1. 首页 -->
    <section id="home">
        <h2>1. 首页 (Home)</h2>
        <p>核心计时控制台，展示今日状态并提供快速操作入口。</p>

        <h3>顶部状态栏</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>昨日/今日勋章</h4>
                <p>基于 <code>GlobalLogic.calculateScore</code> 算法评分。</p>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 无交互，仅展示。</li>
                    <li><strong>逻辑：</strong>
                        <br>≥100分：<strong>圣米迦勒勋章</strong> (紫色流光，带旋转光束)
                        <br>80-99分：<strong>自由勋章</strong> (金色五角星)
                        <br>60-79分：<strong>绿色榕树勋章</strong>
                        <br>&lt;60分：<strong>银色云朵勋章</strong> (灰色)
                    </li>
                </ul>
            </div>
            <div class="card">
                <h4>试用倒计时</h4>
                <p>仅在未解锁 Pro 且处于试用期内显示。</p>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 弹出 <code>PaywallView</code> 付费墙，可查看权益或进行购买。</li>
                    <li><strong>显示逻辑：</strong> 剩余天数 = 30 - (当前日期 - 首次安装日期)。</li>
                </ul>
            </div>
        </div>

        <h3>中央计时器 (Active Ring)</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>圆环交互</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 弹出 <strong>“编辑当前记录”</strong> 弹窗。允许修改当前正在进行记录的开始时间。
                        <br><em>用途：忘记点击开始时，补救开始时间。</em>
                    </li>
                    <li><strong>显示内容：</strong> 当前分类名称、已持续时长 (HH:MM:SS)、开始时间。</li>
                    <li><strong>皮肤：</strong> 可在设置中更换（如流光彗星、量子雷达、自定义照片等）。</li>
                </ul>
            </div>
        </div>

        <h3>底部快速开始 (Category Grid)</h3>
        <p>四个玻璃质感按钮，对应四大核心分类。</p>
        <div class="card">
            <h4>分类按钮</h4>
            <ul class="detail-list">
                <li><span class="gesture g-tap">点击</span> 立即执行 <code>ts.start(category)</code>。</li>
                <li><strong>逻辑 1 (磁吸):</strong> 如果上一个记录结束时间与现在小于 60 秒，新记录会无缝连接上一个记录的结束时间。</li>
                <li><strong>逻辑 2 (自动合并):</strong> 如果点击的分类与正在进行的分类相同，系统会忽略操作（不会切断当前记录）。</li>
                <li><strong>逻辑 3 (覆盖短记录):</strong> 如果当前进行的记录时长小于 1 分钟，切换分类时，旧的短记录会被直接丢弃，新的分类会接管旧的开始时间（防止误触产生垃圾数据）。</li>
            </ul>
        </div>
    </section>

    <!-- 2. 任务清单 -->
    <section id="tasks">
        <h2>2. 任务清单 (Tasks)</h2>
        <p>基于 EventKit 与 iOS 提醒事项双向同步。</p>

        <h3>顶部列表容器 (Horizontal Scroll)</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>全部按钮</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 切换到“显示所有列表任务”模式。</li>
                    <li><span class="gesture g-long">长按</span> 打开 <strong>“全部视图设置”</strong>。
                        <br>• 可开启/关闭“按列表分组显示”。
                        <br>• 可修改全局排序方式（手动/日期/优先级/标题）。
                    </li>
                </ul>
            </div>
            <div class="card">
                <h4>具体列表图标</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 仅筛选该列表的任务。</li>
                    <li><span class="gesture g-long">长按</span> 打开 <strong>“编辑列表”</strong> 弹窗。
                        <br>• 修改列表名称、颜色、图标。
                        <br>• 设置该列表的<strong>默认排序方式</strong>（每个列表可独立设置排序）。
                    </li>
                    <li><span class="gesture g-drag">拖拽归类</span> <strong>高亮功能：</strong> 将下方任务行拖拽至此图标上松手，任务将物理移动至该列表。</li>
                </ul>
            </div>
        </div>

        <h3>任务列表项 (Task Row)</h3>
        <div class="card">
            <h4>交互细节</h4>
            <ul class="detail-list">
                <li><span class="gesture g-tap">点击左侧圆圈</span> 完成/取消完成任务。伴随触觉反馈。</li>
                <li><span class="gesture g-tap">点击文字区域</span> 进入<strong>行内编辑模式</strong>。</li>
                <li><strong>行内编辑时：</strong> 右侧会出现 <kbd>ℹ️</kbd> 图标。
                    <br><span class="gesture g-tap">点击 ℹ️</span> 弹出<strong>详情编辑页</strong>：可修改优先级、旗标、截止日期、所属列表、备注。
                </li>
                <li><span class="gesture g-drag">长按拖拽</span> 
                    <br>1. 上下拖动排序（仅在“手动排序”模式下有效）。
                    <br>2. 拖动到顶部列表图标上，进行<strong>跨列表移动</strong>。
                </li>
                <li><span class="gesture g-swipe">左滑</span> 删除任务。</li>
            </ul>
        </div>

        <h3>底部添加栏</h3>
        <p><span class="gesture g-tap">输入文字 + 回车</span> 快速创建任务。若当前处于“全部”视图，添加到默认列表；若选中特定列表，添加到该列表。</p>
    </section>

    <!-- 3. 日程日历 -->
    <section id="calendar">
        <h2>3. 日程日历 (Calendar)</h2>
        <p>基于 EventKit，管理 iOS 系统日历事件。</p>

        <h3>顶部控制栏</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>功能按钮</h4>
                <ul class="detail-list">
                    <li><span class="icon">⚙️</span> <strong>设置：</strong> 配置默认日程时长、默认提醒时间、默认写入的日历，以及<strong>关联行动类型</strong>（用于自动计时提醒）。</li>
                    <li><span class="icon">📚</span> <strong>课程表模式：</strong> (仅日视图可见)
                        <br>点击后选择“目标星期”和“截止日期”，将<strong>当天的所有日程</strong>作为模板，按周重复复制到选定日期。适合学生排课。
                    </li>
                    <li><strong>日/周/月 切换：</strong> 切换时间轴视图。</li>
                </ul>
            </div>
        </div>

        <h3>日视图 - 时间轴 (Day Timeline)</h3>
        <div class="card">
            <h4>创新交互：草稿模式 (Draft Mode)</h4>
            <p class="tip-box">这是本 App 创建日程的核心方式，比传统点击 +号更直观。</p>
            <ul class="detail-list">
                <li><span class="gesture g-long">长按空白处</span> 并 <span class="gesture g-drag">拖动</span>：
                    <br>• 手指按下处为<strong>开始时间</strong>。
                    <br>• 向下拖动决定<strong>持续时长</strong>。
                    <br>• 松手后生成一个<strong>半透明蓝色草稿块</strong>。
                </li>
                <li><strong>调整草稿：</strong>
                    <br>• 拖动草稿块主体：整体平移时间。
                    <br>• 拖动上下边缘隐形手柄：调整开始或结束时间。
                </li>
                <li><span class="gesture g-tap">点击草稿块</span> 弹出<strong>“新日程”</strong>表单。
                    <br>• 包含标题、位置、备注。
                    <br>• <strong>关键：</strong> 可以选择“关联行动类型”（如工作）。保存后，当该日程开始时，App 会推送通知询问是否切换计时器状态。
                </li>
                <li><strong>取消草稿：</strong> 当草稿存在时，右下角会出现悬浮的“取消新建”按钮，点击即可丢弃。</li>
            </ul>
        </div>
    </section>

    <!-- 4. 档案库 -->
    <section id="archives">
        <h2>4. 档案库 (Archives)</h2>
        <p>高度结构化的数据存储系统，支持 CSV 导入导出。</p>

        <h3>文件夹系统</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>分类管理</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">右上角 +</span> 新建普通文件夹。</li>
                    <li><span class="gesture g-tap">左上角 📥</span> <strong>内部导入：</strong> 扫描 iCloud Drive 中 <code>App容器/导入</code> 目录下的 CSV 文件，点击即可一键导入到“导入”文件夹。</li>
                    <li><span class="gesture g-swipe">左滑分类</span> 删除分类（系统文件夹不可删）。</li>
                    <li><span class="gesture g-swipe">右滑分类</span> 重命名。</li>
                    <li><span class="gesture g-long">长按拖拽</span> 调整分类排序（需在排序菜单选“用户自调”）。</li>
                </ul>
            </div>
        </div>

        <h3>功能模块</h3>
        <div class="card">
            <h4>特殊文件夹</h4>
            <ul class="detail-list">
                <li><strong>模板管理：</strong> 定义表格的列结构。
                    <br>• 支持“普通表格”（Key-Value 结构）和“任务清单”（无限层级结构）。
                    <br>• <strong>样式配置：</strong> 可为每个列定义颜色、字号、字体（圆体/衬线）。
                </li>
                <li><strong>自动填写：</strong> 存放“源文件”。创建新表格时，如果选择“自动填写”模式并指定源文件，新表格会自动继承源文件的数据。</li>
                <li><strong>智能聚合：</strong> 
                    <br>• 创建规则（如：筛选所有表格中包含“待办”的行）。
                    <br>• 跨所有表格搜索符合条件的数据，生成动态视图。
                    <br>• 在聚合视图中直接修改数据，会反向同步到原表格。
                </li>
                <li><strong>删除回收：</strong> 软删除的表格存放于此，支持还原或彻底删除。</li>
            </ul>
        </div>

        <h3>表格详情交互</h3>
        <div class="card">
            <h4>普通表格</h4>
            <ul class="detail-list">
                <li><span class="gesture g-tap">点击行</span> 直接编辑内容。支持多行文本。</li>
                <li><strong>Mac 快捷键：</strong> <kbd>Cmd</kbd> + <kbd>Enter</kbd> 自动跳转下一行。</li>
                <li><strong>右上角菜单：</strong> 导出 Excel / 图片。</li>
            </ul>
            <h4>任务清单 (TaskList)</h4>
            <ul class="detail-list">
                <li><span class="gesture g-tap">点击方框</span> 勾选完成。<strong>级联逻辑：</strong> 勾选父节点，所有子节点自动勾选；取消子节点，父节点自动取消。</li>
                <li><strong>缩进控制：</strong> 工具栏左右箭头，控制任务层级（无限缩进）。</li>
            </ul>
        </div>
    </section>

    <!-- 5. 目标管理 -->
    <section id="goals">
        <h2>5. 目标管理 (Goals)</h2>
        <p>设定并追踪 KPI。</p>

        <h3>视图逻辑</h3>
        <ul class="detail-list">
            <li><strong>iPhone 竖屏 / iPad：</strong> 顶部显示仪表盘，下方显示卡片。</li>
            <li><strong>iPhone 横屏：</strong> 隐藏顶部仪表盘，最大化显示卡片内容（自动缩放适配）。</li>
        </ul>

        <h3>仪表盘 (Dashboard)</h3>
        <div class="card">
            <h4>设定目标</h4>
            <ul class="detail-list">
                <li><span class="gesture g-tap">点击数字</span> 弹出选择器。</li>
                <li><strong>目标时长：</strong> 每日期望的专注小时数（1-24）。</li>
                <li><strong>目标效率：</strong> 期望的平均效率等级（1-10）。</li>
                <li><strong>锁定：</strong> 如果当前查看的是“过去周”，仪表盘锁定不可编辑。</li>
            </ul>
        </div>

        <h3>周视图卡片</h3>
        <div class="card">
            <h4>七日展示</h4>
            <ul class="detail-list">
                <li>展示本周 7 天的效率概览。</li>
                <li><strong>颜色：</strong> 根据得分显示背景色（紫/金/绿/灰）。</li>
                <li><strong>效率豆：</strong> 每一天下方有 3 个胶囊（早/中/晚）。
                    <br><span class="gesture g-tap">点击胶囊</span> 快速修改该时间段的效率自评（1-10）。
                </li>
                <li><span class="gesture g-long">长按某一天</span> 弹出该日的<strong>详细记录列表</strong> Sheet，方便回顾为何得分低。</li>
            </ul>
        </div>
    </section>

    <!-- 6. 历史记录 (重点) -->
    <section id="records">
        <h2>6. 历史记录 (Records)</h2>
        <p>数据修正与审计中心。</p>

        <h3>通用控制</h3>
        <ul class="detail-list">
            <li><strong>撤销/重做：</strong> 底部悬浮按钮 <span class="icon">↩️</span> <span class="icon">↪️</span>。支持撤销所有增删改操作。</li>
            <li><strong>日期切换：</strong> 顶部左右箭头，或点击日期文字选择具体日期。</li>
        </ul>

        <h3>视图 1：列表视图 (List)</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>手势操作</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-tap">点击</span> 修改该记录（时间、分类）。</li>
                    <li><span class="gesture g-swipe">右滑</span> 删除记录。</li>
                    <li><span class="gesture g-swipe">左滑</span> 快速更改分类（工作/生活/刚需/监控）。</li>
                    <li><span class="gesture g-long">长按菜单 (Context Menu)</span> <strong>高阶功能：</strong>
                        <br>• <strong>吞并前后：</strong> 将本记录的时间延长，覆盖掉前一条或后一条记录（吃掉它们）。
                        <br>• <strong>归并：</strong> 仅仅修改本记录的分类，使其与前/后一条相同（常用于合并碎片）。
                        <br>• <strong>延长1小时：</strong> 快速修改结束时间 +1h。
                    </li>
                </ul>
            </div>
        </div>

        <h3>视图 2：时间轴视图 (Timeline)</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>磁吸编辑</h4>
                <ul class="detail-list">
                    <li><span class="gesture g-drag">拖动顶部手柄</span> 
                        <br>• 调整该记录的<strong>开始时间</strong>。
                        <br>• <strong>磁吸：</strong> 拖动时会感到震动吸附，自动吸附到整点（:00）或半点（:30）。
                        <br>• <strong>联动：</strong> 调整开始时间会自动修改上一条记录的结束时间，保持时间流连续。
                    </li>
                    <li><strong>填补空隙：</strong> 如果时间轴有断档（灰色区域），点击底部的 <span class="icon">+</span> 号，App 会自动计算空隙时间并填入“补录弹窗”。</li>
                </ul>
            </div>
        </div>

        <h3>视图 3：饼图 (Pie)</h3>
        <p>展示当天各分类的时间占比。点击中间可切换显示总时长或百分比。</p>
    </section>

    <!-- 7. 番茄专注 -->
    <section id="pomodoro">
        <h2>7. 番茄专注 (Pomodoro)</h2>
        <p>提供沉浸式的专注体验，数据自动计入“历史记录”。</p>

        <h3>横/竖屏差异</h3>
        <div class="feature-grid">
            <div class="card">
                <h4>竖屏 / iPad</h4>
                <p>经典布局。大圆环在中间，时间显示在圆环内部。</p>
            </div>
            <div class="card">
                <h4>iPhone 横屏 (桌面时钟模式)</h4>
                <p><strong>左圈右文布局：</strong> 左侧显示缩小的进度圆环，右侧显示超大字号的倒计时数字。适合放在支架上作为桌面时钟。</p>
            </div>
        </div>

        <h3>交互逻辑</h3>
        <ul class="detail-list">
            <li><span class="gesture g-tap">点击圆环</span> 
                <br>• 空闲时：开始专注。
                <br>• 进行中：暂停/继续。
                <br>• 休息中：跳过休息，直接开始下一轮专注。
            </li>
            <li><span class="gesture g-long">长按圆环</span> <strong>停止 (Stop)：</strong> 放弃当前番茄钟，重置状态。数据会保存为一段记录。</li>
            <li><strong>自动流转：</strong> 专注结束 -> 铃声 -> 自动/手动进入休息 -> 休息结束 -> 铃声 -> 进入下一轮。</li>
        </ul>
    </section>

    <!-- 8. 设置 -->
    <section id="settings">
        <h2>8. 设置 (Settings)</h2>
        <p>偏好配置与高级数据管理。</p>

        <h3>数据管理 (Data)</h3>
        <div class="card">
            <h4>快照与冲突</h4>
            <ul class="detail-list">
                <li><strong>自动快照 (Auto Snapshots)：</strong> 每次 App 进入后台，会自动保存一份全量数据的 JSON 快照。在“数据管理”中可查看最近 30 份快照并<strong>一键回滚</strong>。</li>
                <li><strong>冲突解决 (Conflict Resolution)：</strong> 基于 iCloud 同步。当云端数据修改时间与本地不一致时，会弹出对话框：
                    <br>• 显示冲突模块名称（如“档案库”、“效率数据”）。
                    <br>• 显示两端修改时间。
                    <br>• 让用户选择“保留云端”或“保留本地”。
                </li>
                <li><strong>导出/导入：</strong> 支持将全量数据导出为 JSON 文件分享，或从文件恢复。</li>
            </ul>
        </div>

        <h3>导航栏配置 (Tab Config)</h3>
        <p class="tip-box">此配置存储在本地，iPhone 和 iPad 互不影响。</p>
        <ul class="detail-list">
            <li>可开关底部 7 个 Tab 的显示/隐藏。</li>
            <li><strong>排序：</strong> 拖拽调整 Tab 顺序。</li>
            <li><strong>分页 (iPhone):</strong> 设定每页显示的图标数量（默认4个），超出部分需左右滑动导航栏查看。iPad 默认全部展开。</li>
        </ul>

        <h3>其他设置</h3>
        <ul class="detail-list">
            <li><strong>计时器样式：</strong> 更换首页圆环的皮肤（如原子模型、青春国漫风）。</li>
            <li><strong>磁吸开关：</strong> 开启后，时间轴拖拽会自动吸附。</li>
            <li><strong>日程自动切换：</strong> 开启后，当关联了“工作”分类的日程开始时，App 会发送本地通知，点击通知即可一键将计时器切换为“工作”状态。</li>
        </ul>
    </section>

</main>

<div id="toast">已复制邮箱</div>

<script>
    function copyEmail(e) {
        if(e) e.preventDefault();
        const email = "weightmatrix09@163.com";
        navigator.clipboard.writeText(email).then(() => {
            const toast = document.getElementById("toast");
            toast.className = "show";
            setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
        });
    }

    // 侧边栏导航高亮逻辑
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
                const id = entry.target.getAttribute('id');
                const link = document.querySelector(`nav a[href="#${id}"]`);
                if(link) link.classList.add('active');
            }
        });
    }, { threshold: 0.3 });

    document.querySelectorAll('section').forEach((section) => {
        observer.observe(section);
    });
</script>

</body>
</html>
